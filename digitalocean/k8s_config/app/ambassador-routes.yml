---
apiVersion: getambassador.io/v1
kind: Mapping
metadata:
  name: consul-website-mapping
  namespace: default
spec:
  prefix: /
  host: emojify.today
  service: emojify-website-sidecar-proxy
  resolver: consul-dc1
  tls: ambassador-consul
  load_balancer:
    policy: round_robin

---
apiVersion: getambassador.io/v1
kind: Mapping
metadata:
  name: consul-api-v2-mapping
  namespace: default
spec:
  prefix: /v2/api/
  timeout_ms: 20000
  host: emojify.today
  service: emojify-api-v2-sidecar-proxy
  resolver: consul-dc1
  tls: ambassador-consul
  load_balancer:
    policy: round_robin
  timeout_ms: 4000
  retry_policy:
    retry_on: "5xx"
    num_retries: 2
    per_try_timeout: "2s" 

---
apiVersion: getambassador.io/v1
kind: Mapping
metadata:
  name: consul-grafana-mapping
  namespace: default
spec:
  prefix: /
  host: grafana.emojify.today
  service: grafana-sidecar-proxy
  resolver: consul-dc1
  tls: ambassador-consul
  load_balancer:
    policy: round_robin
